@using Nop.Core.Domain.Tax
@model OrderModel.OrderShippingModel
@if (Model.IsShippable)
{
    <table class="adminContent">
        @if (Model.IsShippable && Model.ShippingAddress != null)
        {
            
            <tr>
                <td class="adminTitle">
                    @Html.NopLabelFor(model => model.ShippingAddress):
                </td>
                <td class="adminData">
                    <table style="border: solid 1px black; padding: 5px;">
                        @if (Model.ShippingAddress.FirstNameEnabled || Model.ShippingAddress.LastNameEnabled)
                        {
                            <tr>
                                <td>
                                    @T("Admin.Orders.Address.FullName"):
                                </td>
                                <td>
                                    @Model.ShippingAddress.FirstName @Model.ShippingAddress.LastName
                                </td>
                            </tr>
                        }
                        @if (Model.ShippingAddress.EmailEnabled)
                        {
                            <tr>
                                <td>
                                    @T("Admin.Orders.Address.Email"):
                                </td>
                                <td>
                                    @Model.ShippingAddress.Email
                                </td>
                            </tr>
                        }
                        @if (Model.ShippingAddress.PhoneEnabled)
                        {
                            <tr>
                                <td>
                                    @T("Admin.Orders.Address.Phone"):
                                </td>
                                <td>
                                    @Model.ShippingAddress.PhoneNumber
                                </td>
                            </tr>
                        }
                        @if (Model.ShippingAddress.FaxEnabled)
                        {
                            <tr>
                                <td>
                                    @T("Admin.Orders.Address.Fax"):
                                </td>
                                <td>
                                    @Model.ShippingAddress.FaxNumber
                                </td>
                            </tr>
                        }
                        @if (Model.ShippingAddress.CompanyEnabled)
                        {
                            <tr>
                                <td>
                                    @T("Admin.Orders.Address.Company"):
                                </td>
                                <td>
                                    @Model.ShippingAddress.Company
                                </td>
                            </tr>
                        }
                        @if (Model.ShippingAddress.StreetAddressEnabled)
                        {
                            <tr>
                                <td>
                                    @T("Admin.Orders.Address.Address1"):
                                </td>
                                <td>
                                    @Model.ShippingAddress.Address1
                                </td>
                            </tr>
                        }
                        @if (Model.ShippingAddress.StreetAddress2Enabled)
                        {
                            <tr>
                                <td>
                                    @T("Admin.Orders.Address.Address2"):
                                </td>
                                <td>
                                    @Model.ShippingAddress.Address2
                                </td>
                            </tr>
                        }
                        @if (Model.ShippingAddress.CityEnabled)
                        {
                            <tr>
                                <td>
                                    @T("Admin.Orders.Address.City"):
                                </td>
                                <td>
                                    @Model.ShippingAddress.City
                                </td>
                            </tr>
                        }
                        @if (Model.ShippingAddress.StateProvinceEnabled)
                        {
                            <tr>
                                <td>
                                    @T("Admin.Orders.Address.StateProvince"):
                                </td>
                                <td>
                                    @Model.ShippingAddress.StateProvinceName
                                </td>
                            </tr>
                        }
                        @if (Model.ShippingAddress.ZipPostalCodeEnabled)
                        {
                            <tr>
                                <td>
                                    @T("Admin.Orders.Address.ZipPostalCode"):
                                </td>
                                <td>
                                    @Model.ShippingAddress.ZipPostalCode
                                </td>
                            </tr>
                        }
                        @if (Model.ShippingAddress.CountryEnabled)
                        {
                            <tr>
                                <td>
                                    @T("Admin.Orders.Address.Country"):
                                </td>
                                <td>
                                    @Model.ShippingAddress.CountryName
                                </td>
                            </tr>
                        }
                        @if (!String.IsNullOrEmpty(Model.ShippingAddress.FormattedCustomAddressAttributes))
                        {
                            <tr class="custom-attributes-view">
                                <td colspan="2">
                                    @Html.Raw(Model.ShippingAddress.FormattedCustomAddressAttributes)
                                </td>
                            </tr>
                        }
                        @if (!Model.IsLoggedInAsVendor)
                        {
                            <tr>
                                <td colspan="2">
                                    <a href="@Url.Action("AddressEdit", new { addressId = Model.ShippingAddress.Id, orderId = Model.Id })" class="k-button">@T("Admin.Common.Edit")</a>
                                </td>
                            </tr>
                        }
                    </table>
                    <div style="padding-top: 15px;">
                        <img alt="google maps" src="@Url.Content("~/Administration/Content/images/google-maps.gif")" />
                        <a href="@Html.Raw(Model.ShippingAddressGoogleMapsUrl)" target="_blank">@T("Admin.Orders.Fields.ShippingAddress.ViewOnGoogleMaps")</a>
                    </div>
                </td>
            </tr>
        }
        <tr>
            <td class="adminTitle">
                @Html.NopLabelFor(model => model.ShippingMethod):
            </td>
            <td class="adminData">
                <span id="lblShippingMethod_@(Model.Id)">@Model.ShippingMethod</span>
                @if (!Model.IsLoggedInAsVendor)
                {
                    <div id="divShippingMethod_@(Model.Id)" style="display: inline-block;">@Html.TextBoxFor(model => model.ShippingMethod, new {id = "current-shipping-method-" + Model.Id, @style= "width: 248px;"})</div>
                    <input type="submit" value="@T("Admin.Common.Edit")" onclick=" toggleEditShippingMethod(@(Model.Id), true);return false; " id="btnEditShippingMethod_@(Model.Id)" class="adminButton" />
                    <input type="submit" value="@T("Admin.Common.Save")" id="btnSaveShippingMethod_@(Model.Id)" name="save-shipping-method-of-order-shipping" class="adminButton" onclick=" return submitEditShippingMethod('@(Model.Id)');" />
                    <input type="submit" value="@T("Admin.Common.Cancel")" onclick=" toggleEditShippingMethod(@(Model.Id), false);return false; " id="btnCancelShippingMethod_@(Model.Id)" class="adminButton" />
                }
            </td>
        </tr>
        @if (!Model.IsLoggedInAsVendor)
        {
            <tr>
                <td class="adminTitle">
                    @Html.NopLabelFor(model => model.ShippingStatus):
                </td>
                <td class="adminData">
                    @Model.ShippingStatus
                </td>
            </tr>
        }
    </table>
    <p>
        <strong>
            @T("Admin.Orders.Products")
        </strong>
    </p>
    <table class="tablestyle" border="1" cellspacing="0" style="width: 100%; border-collapse: collapse;">
                <col />
                <col />
                <col />
                <col />
                <col />
                <col />
                <thead>
                    <tr class="headerstyle">
                        <th align="center">
                            @T("Admin.Orders.Products.Picture")
                        </th>
                        <th align="center">
                            @T("Admin.Orders.Products.ProductName")
                        </th>
                        <th align="center">
                            @T("Admin.Orders.Products.Price")
                        </th>
                        <th align="center">
                            @T("Admin.Orders.Products.Quantity")
                        </th>
                        <th align="center">
                            @T("Admin.Orders.Products.Discount")
                        </th>
                        <th align="center">
                            @T("Admin.Orders.Products.Total")
                        </th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.OrderItems)
                    {
                        <tr>
                            <td align="center" style="width: 10%;">
                                <img src="@item.PictureThumbnailUrl" alt="" title="" />
                            </td>
                            <td style="width: 25%;">
                                <div style="padding-left: 10px; padding-right: 10px; text-align: left;">
                                    <em><a href="@Url.Action("Edit", "Product", new { id = item.ProductId })">@item.ProductName</a></em>
                                    @if (!String.IsNullOrEmpty(item.AttributeInfo))
                                    {
                                        <br />
                                        @Html.Raw(item.AttributeInfo)
                                    }
                                    @if (!String.IsNullOrEmpty(item.RecurringInfo))
                                    {
                                        <br />
                                        @Html.Raw(item.RecurringInfo)
                                    }
                                    @if (!String.IsNullOrEmpty(item.RentalInfo))
                                    {
                                        <br />
                                        @Html.Raw(item.RentalInfo)
                                    }
                                    @if (!String.IsNullOrEmpty(item.Sku))
                                    {
                                        <br />
                                        <strong>@T("Admin.Orders.Products.SKU")</strong><text>:</text>
                                        @item.Sku
                                    }
                                    @if (!String.IsNullOrEmpty(item.VendorName))
                                    {
                                        <br />
                                        <strong>@T("Admin.Orders.Products.Vendor")</strong><text>:</text>
                                        @item.VendorName
                                    }
                                    @if (item.ReturnRequestIds.Count > 0)
                                    {
                                        <br />
                                        <br />
                                        <hr />
                                        @T("Admin.Orders.Products.ReturnRequests")<text>:</text>
                                        for (int i = 0; i < item.ReturnRequestIds.Count; i++)
                                        {
                                        <a href="@Url.Action("Edit", "ReturnRequest", new { id = item.ReturnRequestIds[i] })">@item.ReturnRequestIds[i]</a>
                                            if (i != item.ReturnRequestIds.Count - 1)
                                            {
                                        <text>,</text>
                                            }
                                        }
                                    }
                                    @if (item.PurchasedGiftCardIds.Count > 0)
                                    {
                                        <br />
                                        <br />
                                        <hr />
                                        @T("Admin.Orders.Products.GiftCards")<text>:</text>
                                        for (int i = 0; i < item.PurchasedGiftCardIds.Count; i++)
                                        {
                                        <a href="@Url.Action("Edit", "GiftCard", new { id = item.PurchasedGiftCardIds[i] })">@item.PurchasedGiftCardIds[i]</a>
                                            if (i != item.PurchasedGiftCardIds.Count - 1)
                                            {
                                        <text>,</text>
                                            }
                                        }
                                    }
                                </div>
                            </td>
                            <td align="center" style="width: 15%;">
                                @item.UnitPriceExclTax
                                <br/>
                                @item.UnitPriceInclTax
                            </td>
                            <td align="center" style="width: 10%;">
                                <div>@item.Quantity</div>
                            </td>
                            <td align="center" style="width: 15%;">
                                @item.DiscountInclTax
                                    <br />
                                    @item.DiscountExclTax
                            </td>
                            <td align="center" style="width: 15%;">
                                @item.SubTotalInclTax
                                    <br />
                                    @item.SubTotalExclTax
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
    <p>
        <strong>
            @T("Admin.Orders.Shipments")
        </strong>
    </p>
    <table class="adminContent">
        <tr>
            <td>
                <div id="shipments-grid_@Model.Id"></div>
             </td>
        </tr>
        @if (Model.CanAddNewShipments)
        {
            <tr>
                <td class="adminData">
                    <input type="submit" id="btnAddNewShipment" name="btnAddNewShipment" value="@T("Admin.Orders.Shipments.AddNew")" onclick="javascript:setLocation('@(Url.Action("AddShipmentToOrderShipping", "Order", new { orderShippingId = Model.Id }))'); return false;" class="k-button" />
                </td>
            </tr>
        }
    </table>
}
else
{
    <table class="adminContent">
        <tr>
            <td class="adminTitle"></td>
            <td class="adminData">
                @T("Admin.Orders.ShippingInfo.NotRequired")
            </td>
        </tr>
    </table>
}